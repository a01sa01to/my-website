<!DOCTYPE html>
<html lang="ja">
<head>
  <title>AHC003 - Asa's Blog</title>
  <link type="application/atom+xml" rel="alternate" href="https://a01sa01to.com/feed.xml" title="Asa's Website" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width,minimum-scale=1.0, initial-scale=1.0, maximum-scale=10.0, shrink-to-fit=no">


<meta name="keywords" content="a01sa01to">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:domain" content="https://a01sa01to.com/">
<meta name="twitter:site" content="@a01sa01to">
<meta name="twitter:creator" content="@a01sa01to">
<meta property="og:url" content="https://a01sa01to.com/blog/2021/06/ahc003">
<meta property="og:title" content=" - Asa's Blog" lang="ja">
<meta property="og:title" content=" - Asa's Blog" lang="en">
<meta property="og:image" content="https://a01sa01to.com/img/twittercard.jpg">
<meta property="og:type" content="website">
<link rel="canonical" href="https://a01sa01to.com/blog/2021/06/ahc003">

<!-- Change Chrome Tab Color -->
<meta name="theme-color" content="#ffffff">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
<link rel="stylesheet" href="/css/main.css">
  <script src="https://kit.fontawesome.com/7fba4a39db.js" crossorigin="anonymous" async></script>
<script src="/bundle.js"></script>
<script data-ad-client="ca-pub-3296104264173235" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z23EQDNLQY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z23EQDNLQY');
</script>
  <link rel="canonical" href="https://a01sa01to.com/blog/2021/06/ahc003">
  <link rel="stylesheet" href="/css/blog_post.css">
</head>
<body id="top">
  <header><div id="left"></div>
<div id="center">
  <p id="title">Asa's Blog</p>
</div>
<div id="right">
  <input type="checkbox" id="menuShow">
  <div id="menuIcon"><div id="bar1"></div><div id="bar2"></div></div>
  <div id="menuItem">
    <li><a href="/blog/">Blog Top</a></li>
    
    
    <p class="border"></p>
    <li><a href="/">Asa's Website Home</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/opendata/">Opendata Catalog</a></li>
    <li><a href="/works">Works</a></li>
    <li><a href="/sitemap/">Sitemap</a></li>
    <li class="social">
      <a href="https://github.com/a01sa01to" target="_blank" rel="noopener noreferrer">
        <i class="fab fa-github"></i>
      </a>
      <a href="https://twitter.com/a01sa01to" target="_blank" rel="noopener noreferrer">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://instagram.com/a01sa01to" target="_blank" rel="noopener noreferrer">
        <i class="fab fa-instagram"></i>
      </a>
      <a href="/feed.xml" target="_blank" rel="noopener">
        <i class="fas fa-rss"></i>
      </a>
    </li>
    <p class="border"></p>
    <li><a href="?lang=ja">Japanese</a></li>
    <li><a href="?lang=en">English</a></li>
    <li style="height: 54px;"></li>
  </div>
</div></header>
  <main>
    <div class="container">
      <div>
        <h1>AHC003</h1>
        
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb" lang="ja">
            <li class="breadcrumb-item"><a href="/blog/">Home</a></li>
            <li class="breadcrumb-item"><a href="/blog/list/2021">2021年の記事</a></li>
            <li class="breadcrumb-item active" aria-current="page">この記事</li>
          </ol>
        </nav>

        <p class="tags">
          Tags:
          
            <a href="/blog/tags/atcoder/" class="tag">AtCoder</a>&nbsp;
          
            <a href="/blog/tags/ahc/" class="tag">AHC</a>&nbsp;
          
            <a href="/blog/tags/competitive-programming/" class="tag">Competitive-Programming</a>&nbsp;
          
        </p>
        <p class="date"><nobr>Published on 2021.06.01.<wbr> Last Modified on 2020.06.01.</nobr></p>
        <div class="accordion" id="toc">
          <div class="accordion-item">
            <p class="accordion-header" id="headingToc">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseToc" aria-expanded="false" aria-controls="collapseToc">
                Table of Contents
              </button>
            </p>
            <div id="collapseToc" class="accordion-collapse collapse" aria-labelledby="headingToc" data-bs-parent="#toc">
              <div class="accordion-body"></div>
            </div>
          </div>
        </div>
        <div class="article">
          <script>
  MathJax = {
    tex: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true,
      tags: "ams",
      autoload: {
        color: [],
        colorV2: ['color']
      },
      packages: {'[+]': ['noerrors']}
    },
    chtml: {
      matchFontHeight: false,
      displayAlign: "left",
      displayIndent: "2em"
    },
    options: {
      renderActions: {
        /* add a new named action to render <script type="math/tex"> */
        find_script_mathtex: [10, function (doc) {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/);
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
            const text = document.createTextNode('');
            node.parentNode.replaceChild(text, node);
            math.start = {node: text, delim: '', n: 0};
            math.end = {node: text, delim: '', n: 0};
            doc.math.push(math);
          }
        }, '']
      }
    },
    loader: {
      load: ['[tex]/noerrors']
    }
  };
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>

<p><a href="/blog/2021/05/abc203">ABC203</a> に引き続き、AHC003を振り返ります。</p>

<h2 id="問題概要">問題概要</h2>

<ul>
  <li>クエリが1000個与えられるので、30x30のグラフで、最短経路を予測。</li>
  <li>出力したら flush しないと <code class="language-plaintext highlighter-rouge">TLE</code> になる。</li>
  <li>出力されたら［出力されたパスの長さ $ b_k $ × 乱数（0.9～1.1） $ e_k $ ］が標準入力に入る。</li>
  <li>同じところを何回も通ったり、はみ出したり、ちゃんとゴールにつけてなかったりすると <code class="language-plaintext highlighter-rouge">WA</code> で0点。</li>
  <li>得点は、 $ \mathrm{round}(2312311\times \sum_{k=1}^{1000}0.998^{1000-k} \frac{a_k}{b_k}) $ 。なお、最短経路が $ a_k $ で、出力パスが $ b_k $ 。</li>
  <li>実行時間制限は 2sec、メモリ制限は1024MB。</li>
  <li>暫定テストでは100個のテストケース。1つ当たり $ 10^9 $ 点で、 満点は $ 10^{11} $ 点。</li>
</ul>

<h2 id="実装してみる">実装してみる</h2>
<p>一応 <a href="https://atcoder.jp/contests/ahc003/submissions?f.User=a01sa01to">こちらから</a> 私の実装を見れます。</p>

<h3 id="エイリアス定義など">エイリアス定義など</h3>
<p>私は main() 関数前に以下の定義をしています。型宣言等でわからないところがあったら参照していただければ。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define _GLIBCXX_DEBUG
#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ull</span> <span class="o">=</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ull1d</span> <span class="o">=</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ull</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ull2d</span> <span class="o">=</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ull1d</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ull3d</span> <span class="o">=</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ull2d</span><span class="o">&gt;</span><span class="p">;</span>
<span class="cp">#define loop(i,n) for(ull i=0;i&lt;n;i++)
#define rloop(i,n) for(ll i=n-1;i&gt;=0;i--)
#define all(vec) vec.begin(),vec.end()
</span></code></pre></div></div>

<h3 id="試しにとりあえず直線的に移動する">試しにとりあえず直線的に移動する</h3>
<p><a href="https://atcoder.jp/contests/ahc003/submissions/22779476">提出 #22779476 - AtCoder Heuristic Contest 003</a> <br />
とにかく同じ行になるまで上下どっちかに移動して、そのあとゴールへ一直線する寸法です。とりあえず出力後に入る $ b_k \times e_k $ は無視します。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1000</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">sy</span> <span class="o">&gt;&gt;</span> <span class="n">sx</span> <span class="o">&gt;&gt;</span> <span class="n">ty</span> <span class="o">&gt;&gt;</span> <span class="n">tx</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sy</span> <span class="o">&gt;</span> <span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">sy</span><span class="o">-</span><span class="n">ty</span><span class="p">){</span> <span class="n">res</span><span class="o">+=</span><span class="s">"U"</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sy</span> <span class="o">&lt;</span> <span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ty</span><span class="o">-</span><span class="n">sy</span><span class="p">){</span> <span class="n">res</span><span class="o">+=</span><span class="s">"D"</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sx</span> <span class="o">&gt;</span> <span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">sx</span><span class="o">-</span><span class="n">tx</span><span class="p">){</span> <span class="n">res</span><span class="o">+=</span><span class="s">"L"</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sx</span> <span class="o">&lt;</span> <span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">tx</span><span class="o">-</span><span class="n">sx</span><span class="p">){</span> <span class="n">res</span><span class="o">+=</span><span class="s">"R"</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="n">ll</span> <span class="n">point</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">point</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>これで 63,179,310,956 点得られました。これでも63%とれるみたいです。</p>

<h3 id="-b_k-times-e_k--を使う">$ b_k \times e_k $ を使う</h3>
<p><a href="https://atcoder.jp/contests/ahc003/submissions/22783808">提出 #22783808 - AtCoder Heuristic Contest 003</a><br />
$ b_k \times e_k $ は実質経路の長さなので、最短経路を求めるにはこれを使わないわけにはいかないという。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
<span class="n">ull</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">move</span><span class="p">(</span><span class="kt">char</span> <span class="n">mode</span><span class="p">){</span>
  <span class="k">switch</span> <span class="p">(</span><span class="n">mode</span><span class="p">){</span>
    <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"U"</span><span class="p">;</span> <span class="n">y</span><span class="o">--</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"D"</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"L"</span><span class="p">;</span> <span class="n">x</span><span class="o">--</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"R"</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ull3d</span> <span class="nf">Graph</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull2d</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull1d</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)));</span>
<span class="c1">// Graph[i][j] = {Up, Down, Left, Right}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1000</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">sy</span> <span class="o">&gt;&gt;</span> <span class="n">sx</span> <span class="o">&gt;&gt;</span> <span class="n">ty</span> <span class="o">&gt;&gt;</span> <span class="n">tx</span><span class="p">;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sy</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">y</span><span class="o">!=</span><span class="n">ty</span> <span class="o">||</span> <span class="n">x</span><span class="o">!=</span><span class="n">tx</span><span class="p">){</span>
      <span class="n">ull1d</span> <span class="n">now</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">];</span>
      <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">ty</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="n">tx</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'L'</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">ty</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">tx</span><span class="o">-</span><span class="n">x</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'R'</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">ty</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'U'</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ty</span><span class="o">-</span><span class="n">y</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'D'</span><span class="p">);</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'U'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'L'</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">now</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'U'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span><span class="p">{</span> <span class="n">move</span><span class="p">(</span><span class="sc">'L'</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">ty</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'D'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'L'</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">now</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'D'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span><span class="p">{</span> <span class="n">move</span><span class="p">(</span><span class="sc">'L'</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'U'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'R'</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">now</span><span class="p">[</span><span class="mi">3</span><span class="p">]){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'U'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span><span class="p">{</span> <span class="n">move</span><span class="p">(</span><span class="sc">'R'</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">ty</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'D'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'R'</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">now</span><span class="p">[</span><span class="mi">3</span><span class="p">]){</span> <span class="n">move</span><span class="p">(</span><span class="sc">'D'</span><span class="p">);</span> <span class="p">}</span> <span class="k">else</span><span class="p">{</span> <span class="n">move</span><span class="p">(</span><span class="sc">'R'</span><span class="p">);</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">ull</span> <span class="n">point</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">point</span><span class="p">;</span>
    <span class="n">point</span> <span class="o">/=</span> <span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sy</span><span class="p">;</span>
    <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
      <span class="k">switch</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
        <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">y</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">y</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">x</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">x</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ここで何をしているかというと、</p>
<ol>
  <li>すべての地点に対して上下左右の経路を0で初期化</li>
  <li>自分がゴール地点にいない限り、今ゴールの左上にいるなら、右か下の経路の短いほうへ行く。右上なら左か下、左下なら右か上、右下なら左か上、といった具合に移動。</li>
  <li>出力し、すぐに flush する</li>
  <li>得点を歩数で割って、各経路に max(経路, 得点÷歩数) を代入する。訪れていない場合、(経路)=0となっているため、必ず［得点÷歩数］が入る仕組み。</li>
  <li>繰り返し…</li>
</ol>

<p>これだと 69,388,118,612 点。得点率は6%くらい上がりました。</p>

<h3 id="全探索してみる">全探索してみる</h3>
<p><a href="https://atcoder.jp/contests/ahc003/submissions/22787318">提出 #22787318 - AtCoder Heuristic Contest 003</a><br />
もっと得点ほしい！！ってなったので、1歩先ではなく、ある程度先まで読める全探索でやってみます。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ull3d</span> <span class="nf">Graph</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull2d</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull1d</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)));</span>
<span class="c1">// Graph[i][j] = {Up, Down, Left, Right}</span>

<span class="n">ull</span> <span class="nf">leng</span><span class="p">(</span><span class="n">string</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ull</span> <span class="n">x</span><span class="p">,</span> <span class="n">ull</span> <span class="n">y</span><span class="p">){</span>
  <span class="n">ull</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mode</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
      <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span> <span class="n">ret</span> <span class="o">+=</span> <span class="mi">10000</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">y</span><span class="o">--</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span> <span class="n">ret</span> <span class="o">+=</span> <span class="mi">10000</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">y</span><span class="o">++</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span> <span class="n">ret</span> <span class="o">+=</span> <span class="mi">10000</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">x</span><span class="o">--</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">];</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span> <span class="n">ret</span> <span class="o">+=</span> <span class="mi">10000</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">x</span><span class="o">++</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1000</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">sy</span> <span class="o">&gt;&gt;</span> <span class="n">sx</span> <span class="o">&gt;&gt;</span> <span class="n">ty</span> <span class="o">&gt;&gt;</span> <span class="n">tx</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="n">ll</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sy</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="o">!=</span><span class="n">tx</span> <span class="o">||</span> <span class="n">y</span><span class="o">!=</span><span class="n">ty</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">ty</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="n">tx</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"L"</span><span class="p">;</span> <span class="n">x</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">ty</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">tx</span><span class="o">-</span><span class="n">x</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"R"</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">ty</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"U"</span><span class="p">;</span> <span class="n">y</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ty</span><span class="o">-</span><span class="n">y</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"D"</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span><span class="p">{</span>
        <span class="n">string</span> <span class="n">best</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span> <span class="n">ll</span> <span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">;</span> <span class="n">ull</span> <span class="n">bestRoute</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">bitLoop</span> <span class="o">=</span> <span class="n">min</span><span class="p">((</span><span class="n">ll</span><span class="p">)</span><span class="mi">8</span><span class="p">,</span><span class="n">min</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">tx</span><span class="p">),</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">ty</span><span class="p">)));</span>
        <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">bitLoop</span><span class="p">){</span>
          <span class="n">string</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span> <span class="n">ll</span> <span class="n">mx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">my</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
          <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span>
            <span class="c1">// U or L</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"U"</span><span class="p">;</span> <span class="n">my</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"L"</span><span class="p">;</span> <span class="n">mx</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">ty</span><span class="p">){</span>
            <span class="c1">// D or L</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"D"</span><span class="p">;</span> <span class="n">my</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"L"</span><span class="p">;</span> <span class="n">mx</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span>
            <span class="c1">// U or R</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"U"</span><span class="p">;</span> <span class="n">my</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"R"</span><span class="p">;</span> <span class="n">mx</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span><span class="p">{</span>
            <span class="c1">// D or R</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"D"</span><span class="p">;</span> <span class="n">my</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"R"</span><span class="p">;</span> <span class="n">mx</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="n">ull</span> <span class="n">tmpL</span> <span class="o">=</span> <span class="n">leng</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
          <span class="k">if</span><span class="p">(</span><span class="n">tmpL</span> <span class="o">&gt;</span> <span class="n">bestRoute</span><span class="p">){</span>
            <span class="n">bestRoute</span> <span class="o">=</span> <span class="n">tmpL</span><span class="p">;</span>
            <span class="n">best</span> <span class="o">=</span> <span class="n">mode</span><span class="p">;</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="n">mx</span><span class="p">;</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">my</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">best</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">nx</span><span class="p">;</span> <span class="n">y</span> <span class="o">+=</span> <span class="n">ny</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="n">ull</span> <span class="n">point</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">point</span><span class="p">;</span>
    <span class="n">point</span> <span class="o">/=</span> <span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sy</span><span class="p">;</span>
    <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
      <span class="k">switch</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
        <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">y</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">y</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">x</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">x</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>これで $ \min(8, \vert x-tx \vert , \vert y-ty \vert) $ 歩先まで読んで、一番経路が短い（と思っていた）ものを求めます。<br />
同じ行・列になった場合、ゴールまで直進します。<br />
訪れていない場合は、経路を10,000に設定して、優先的に選ばれるようにしています。</p>

<p>結果、52,326,846,043 点。落ちてるやん。<br />
9歩先を読んでも、61,387,035,970	点。</p>

<h3 id="そして気づく">そして気づく</h3>

<p>「あっ。最短経路を求めるやつやん。なんで訪れてない場合10,000にして経路長いほう選んでるんだ…。」</p>

<p><a href="https://atcoder.jp/contests/ahc003/submissions/22842801">提出 #22842801 - AtCoder Heuristic Contest 003</a><br />
で訂正（したつもり）。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ull3d</span> <span class="nf">Graph</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull2d</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull1d</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)));</span>
<span class="c1">// Graph[i][j] = {Up, Down, Left, Right}</span>

<span class="n">ull</span> <span class="nf">leng</span><span class="p">(</span><span class="n">string</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ull</span> <span class="n">x</span><span class="p">,</span> <span class="n">ull</span> <span class="n">y</span><span class="p">,</span> <span class="n">ull</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ull</span> <span class="n">ty</span><span class="p">){</span>
  <span class="n">ull</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mode</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
      <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">ty</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">y</span><span class="o">--</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">ty</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">y</span><span class="o">++</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">tx</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">x</span><span class="o">--</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">tx</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">x</span><span class="o">++</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="kt">double</span> <span class="n">prevScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1000</span><span class="p">){</span>
    <span class="c1">// 省略</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="n">ull</span> <span class="n">point</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">point</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">tmpScore</span> <span class="o">=</span> <span class="n">point</span><span class="p">;</span>
    <span class="n">point</span> <span class="o">=</span> <span class="mf">1e10</span> <span class="o">-</span> <span class="p">(</span><span class="n">point</span> <span class="o">-</span> <span class="p">(</span><span class="n">prevScore</span><span class="o">/</span><span class="mf">0.998</span><span class="p">));</span>
    <span class="n">point</span> <span class="o">/=</span> <span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">prevScore</span> <span class="o">=</span> <span class="n">tmpScore</span><span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sy</span><span class="p">;</span>
    <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
      <span class="k">switch</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
        <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">y</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">y</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">x</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">);</span>
          <span class="n">x</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>10歩先を読んでも、61,387,035,970 点。<br />
入力される得点をなぜか <code class="language-plaintext highlighter-rouge">point = 1e10 - (point - (prevScore/0.998))</code> としていたため、実質的には最長経路を求めることになり、あまり伸びず…。</p>

<h3 id="平均値をとってみる">平均値をとってみる</h3>
<p><a href="https://atcoder.jp/contests/ahc003/submissions/22907260">提出 #22907260 - AtCoder Heuristic Contest 003</a><br />
入力は $ b_k \times e_k $ であることに気付いたため、先ほどの部分を削除。$ \max $ 関数だと外れ値に当たった時怖いな…と考えて、相加平均をとることにしました。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ull3d</span> <span class="nf">Graph</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull2d</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">ull1d</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)));</span>
<span class="c1">// Graph[i][j] = {Up, Down, Left, Right}</span>

<span class="n">ull</span> <span class="nf">leng</span><span class="p">(</span><span class="n">string</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ull</span> <span class="n">x</span><span class="p">,</span> <span class="n">ull</span> <span class="n">y</span><span class="p">,</span> <span class="n">ull</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ull</span> <span class="n">ty</span><span class="p">){</span>
  <span class="n">ull</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mode</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
      <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">ty</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">y</span><span class="o">--</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">ty</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">y</span><span class="o">++</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">tx</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">x</span><span class="o">--</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">tx</span><span class="p">){</span> <span class="k">return</span> <span class="mf">1e10</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span> <span class="n">ret</span> <span class="o">+=</span> <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">];</span> <span class="p">}</span>
        <span class="n">x</span><span class="o">++</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="n">loop</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1000</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">sy</span> <span class="o">&gt;&gt;</span> <span class="n">sx</span> <span class="o">&gt;&gt;</span> <span class="n">ty</span> <span class="o">&gt;&gt;</span> <span class="n">tx</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="n">ll</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sy</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="o">!=</span><span class="n">tx</span> <span class="o">||</span> <span class="n">y</span><span class="o">!=</span><span class="n">ty</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">ty</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="n">tx</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"L"</span><span class="p">;</span> <span class="n">x</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">ty</span> <span class="o">&amp;&amp;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">tx</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">tx</span><span class="o">-</span><span class="n">x</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"R"</span><span class="p">;</span> <span class="n">x</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">ty</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"U"</span><span class="p">;</span> <span class="n">y</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">ty</span><span class="p">){</span> <span class="n">loop</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">ty</span><span class="o">-</span><span class="n">y</span><span class="p">){</span> <span class="n">res</span> <span class="o">+=</span> <span class="s">"D"</span><span class="p">;</span> <span class="n">y</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span>
      <span class="k">else</span><span class="p">{</span>
        <span class="n">string</span> <span class="n">best</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span> <span class="n">ll</span> <span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">;</span> <span class="n">ull</span> <span class="n">bestRoute</span><span class="o">=</span><span class="mf">1e10</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">bitLoop</span> <span class="o">=</span> <span class="n">min</span><span class="p">((</span><span class="n">ll</span><span class="p">)</span><span class="mi">10</span><span class="p">,</span> <span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">tx</span><span class="p">)</span><span class="o">+</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">ty</span><span class="p">));</span>
        <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">bitLoop</span><span class="p">){</span>
          <span class="n">string</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span> <span class="n">ll</span> <span class="n">mx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">my</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
          <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span>
            <span class="c1">// U or L</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"U"</span><span class="p">;</span> <span class="n">my</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"L"</span><span class="p">;</span> <span class="n">mx</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">ty</span><span class="p">){</span>
            <span class="c1">// D or L</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"D"</span><span class="p">;</span> <span class="n">my</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"L"</span><span class="p">;</span> <span class="n">mx</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">tx</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">&gt;</span><span class="n">ty</span><span class="p">){</span>
            <span class="c1">// U or R</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"U"</span><span class="p">;</span> <span class="n">my</span><span class="o">--</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"R"</span><span class="p">;</span> <span class="n">mx</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">else</span><span class="p">{</span>
            <span class="c1">// D or R</span>
            <span class="n">loop</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">bitLoop</span><span class="p">){</span>
              <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">){</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"D"</span><span class="p">;</span> <span class="n">my</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
              <span class="k">else</span><span class="p">{</span> <span class="n">mode</span> <span class="o">+=</span> <span class="s">"R"</span><span class="p">;</span> <span class="n">mx</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="n">ull</span> <span class="n">tmpL</span> <span class="o">=</span> <span class="n">leng</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">tx</span><span class="p">,</span><span class="n">ty</span><span class="p">);</span>
          <span class="k">if</span><span class="p">(</span><span class="n">tmpL</span> <span class="o">&lt;</span> <span class="n">bestRoute</span><span class="p">){</span>
            <span class="n">bestRoute</span> <span class="o">=</span> <span class="n">tmpL</span><span class="p">;</span>
            <span class="n">best</span> <span class="o">=</span> <span class="n">mode</span><span class="p">;</span>
            <span class="n">nx</span> <span class="o">=</span> <span class="n">mx</span><span class="p">;</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">my</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">best</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">nx</span><span class="p">;</span> <span class="n">y</span> <span class="o">+=</span> <span class="n">ny</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">res</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
    <span class="n">ull</span> <span class="n">point</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">point</span><span class="p">;</span>
    <span class="n">point</span> <span class="o">/=</span> <span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sy</span><span class="p">;</span>
    <span class="n">loop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
      <span class="k">switch</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
        <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">y</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">y</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">x</span><span class="o">--</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="n">x</span><span class="o">++</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ゴール地点の座標を超えていた場合、経路の長さを $ 10^{10} $ にすることで選ばれないようにして、経路長さ更新は相加平均 $ {a+b} \over 2 $ にしてみました。<br />
10歩先を読んで、73,881,366,834 点。爆上がりしました。<br />
あとは実行時間制限とのチキンレース。10歩で288msだったので、実行時間ギリギリを攻めます。<br />
11歩で 74,551,308,026 点（550ms）、12歩で 75,212,574,804 点（970ms）、13歩で 76,004,221,978 点（1969ms）。<br />
本番で <code class="language-plaintext highlighter-rouge">TLE</code> になったら怖いので、12歩にロールバックしました。</p>

<h3 id="またも気づく">またも気づく</h3>
<p>経路長さの更新時、</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">switch</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
    <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">y</span><span class="o">--</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">y</span><span class="o">++</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">x</span><span class="o">--</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">point</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">x</span><span class="o">++</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></div></div>
<p>としていました。</p>

<p>「あっ、<code class="language-plaintext highlighter-rouge">L</code> と <code class="language-plaintext highlighter-rouge">R</code> の場合の処理、正しく書けてないやん…」</p>

<p><a href="https://atcoder.jp/contests/ahc003/submissions/23020247">提出 #23020247 - AtCoder Heuristic Contest 003</a><br />
これを訂正して、12歩先を読んで、81,150,992,107 点（1084ms）。夢の8割に到達…！</p>

<h3 id="相乗平均をとってみる">相乗平均をとってみる</h3>
<p><a href="https://atcoder.jp/contests/ahc003/submissions/23020788">提出 #23020788 - AtCoder Heuristic Contest 003</a><br />
<del>何を思ったか、</del> 相乗平均をとってみました。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">switch</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
  <span class="k">case</span> <span class="sc">'U'</span><span class="p">:</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">y</span><span class="o">--</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="sc">'D'</span><span class="p">:</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">y</span><span class="o">++</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="sc">'L'</span><span class="p">:</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">x</span><span class="o">--</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="sc">'R'</span><span class="p">:</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Graph</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">point</span><span class="p">);</span>
    <span class="n">x</span><span class="o">++</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>オーバーフローのことを一応考えて、それぞれについて <code class="language-plaintext highlighter-rouge">sqrt</code> してます。<br />
結果、62,207,792,606 点。経路長を0で初期化したことが原因のようです。<br />
<a href="https://atcoder.jp/contests/ahc003/submissions/23025023">1で初期化するよう訂正</a>した結果、77,153,634,281 点。相加平均には敵わず…。<br />
相加平均にロールバックしました。</p>

<p>そして終了…。</p>

<h2 id="結果">結果</h2>

<p>3,000件あるテストケースで、それぞれについて1,000,000,000 ( $ 10^9 $ ) 点が満点になるので、全部の満点は $ 3.0 \times 10^{12} $ になります。<br />
そして私が得た得点は、2,442,902,260,623 点。81.4%の得点率で、519位でした。<br />
8割得点しましたが、未提出者（0点）で860位なので半分以下みたいです。</p>

<p>もっと問題文を理解できるようにしたりアルゴリズムを学んだりして、ABCはもちろんAHCでも高得点を狙っていきたいですね…。</p>

          <p class="a_few_word">AHCは、とにかく Try & Error してみるのが重要なのかも。</p>
        </div>
      </div>
    </div>
  </main>
  <footer><div class='sb'>
  Share this page!
	<div class='sbInner'>
		<!-- Facebook -->
		<a class='shadow-lg mb-5 rounded sBtn sBtn-facebook' href="https://www.facebook.com/sharer/sharer.php?u=PAGEURL" rel='nofollow' target='_blank' title="Share on Facebook"><i class="fab fa-facebook-f"></i></a>
		<!-- Twitter -->
		<a class='shadow-lg mb-5 rounded sBtn sBtn-twitter' href="http://twitter.com/share?url=PAGEURL&text=PAGETITLE&via=a01sa01to" rel='nofollow' target='_blank' title="Share on Twitter"><i class="fab fa-twitter"></i></a>
		<!-- LINE -->
		<a class='shadow-lg mb-5 rounded sBtn sBtn-line' href="http://line.me/R/msg/text/?PAGETITLE%0APAGEURL" rel='nofollow' target='_blank' title='Share on LINE'><i class="fab fa-line"></i></a>
		<!-- Pocket -->
		<a class='shadow-lg mb-5 rounded sBtn sBtn-pocket' href="https://getpocket.com/edit?url=PAGEURL&title=PAGETITLE" rel='nofollow' target='blank' title='Share on Pocket'><i class="fab fa-get-pocket"></i></a>
		<!-- B! Hatena -->
		<a class='shadow-lg mb-5 rounded sBtn sBtn-hatena' href="https://b.hatena.ne.jp/add?mode=confirm&url=PAGEURL&title=PAGETITLE" rel='nofollow' target='_blank' title='Share on Hatena'><i aria-hidden='true' class='fa fa-hatena' style='font-weight: bold;'>B!</i></a>
	</div>
</div>

<p id="copyright">Copyright &copy; 2020-2021 Asa(@a01sa01to)</p></footer>
  <a href="#top" id="gototop"><span class="material-icons">keyboard_arrow_up</span></a>
</body>
</html>